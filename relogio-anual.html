<!DOCTYPE html>
<html lang="pt-pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Relógio Anual</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background-color: #000000;
            color: #f8fafc;
            overflow: hidden;
            font-family: 'Inter', system-ui, -apple-system, sans-serif;
            display: flex;
            flex-direction: column;
            height: 100vh;
        }

        header {
            padding: 1.5rem 1rem 0.5rem 1rem;
            text-align: center;
            z-index: 10;
        }

        #canvas-container {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 1rem;
            overflow: hidden;
        }

        /* Estrutura do cabeçalho técnico */
        .header-line {
            stroke: #ffffff;
            stroke-width: 0.3;
            opacity: 0.15;
        }

        .weekday-header {
            font-size: 9px;
            fill: #ffffff;
            font-weight: 900;
            text-anchor: middle;
            opacity: 0.4;
        }

        /* Detalhes do Relógio */
        .tick-hour { stroke: #cbd5e1; stroke-width: 0.4; opacity: 0.8; }
        .tick-min  { stroke: #64748b; stroke-width: 0.2; opacity: 0.6; }

        /* Ponteiros ultra-finos */
        .hand-hour { stroke: #ef4444; stroke-width: 0.6; stroke-linecap: round; }
        .hand-min  { stroke: #f8fafc; stroke-width: 0.6; stroke-linecap: round; opacity: 0.7; }
        .hand-sec  { stroke: #3b82f6; stroke-width: 0.6; stroke-linecap: round; }

        /* Glow Branco Intensificado para os relógios normais */
        .clock-face-base {
            fill: url(#whiteGlowGradient); 
            stroke: rgba(255, 255, 255, 0.3);
            stroke-width: 0.3;
            filter: drop-shadow(0 0 3px rgba(255, 255, 255, 0.4)) drop-shadow(0 0 1px rgba(255, 255, 255, 0.2));
        }

        /* Glow Vermelho Neon para o dia actual */
        .today-rim-glow {
            stroke: #ef4444;
            stroke-width: 0.8;
            fill: none;
            filter: drop-shadow(0 0 4px rgba(239, 68, 68, 0.9)) drop-shadow(0 0 8px rgba(239, 68, 68, 0.4));
        }

        /* Gráfico de Progresso com Glow Verde */
        #today-progress-pie {
            fill: #10b981;
            fill-opacity: 0.45;
            stroke: #10b981;
            stroke-width: 0.2;
            filter: drop-shadow(0 0 5px rgba(16, 185, 129, 0.8));
        }

        .month-marker {
            font-size: 8px;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            text-anchor: middle;
            pointer-events: none;
        }

        #current-info {
            letter-spacing: 0.15em;
            background: rgba(15, 23, 42, 0.3);
            transition: all 0.5s ease;
        }

        .tooltip {
            position: absolute;
            background: rgba(0, 0, 0, 0.98);
            border: 1px solid #334155;
            padding: 12px 16px;
            border-radius: 8px;
            font-size: 14px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.2s;
            z-index: 100;
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(8px);
        }
    </style>
</head>
<body>

    <header>
        <div id="current-info" class="font-mono text-xl sm:text-2xl px-10 py-4 rounded-2xl border border-slate-800 shadow-2xl backdrop-blur-md">
            -- : -- : --
        </div>
    </header>

    <div id="canvas-container">
        <svg id="time-matrix" viewBox="0 0 850 820" preserveAspectRatio="xMidYMid meet" class="max-h-[90vh] max-w-full">
            <defs>
                <!-- Gradiente circular Branco mais forte -->
                <radialGradient id="whiteGlowGradient" cx="50%" cy="50%" r="50%" fx="50%" fy="50%">
                    <stop offset="0%" stop-color="rgba(255, 255, 255, 0.35)" />
                    <stop offset="60%" stop-color="rgba(255, 255, 255, 0.12)" />
                    <stop offset="100%" stop-color="rgba(255, 255, 255, 0)" />
                </radialGradient>
            </defs>
            <g id="header-layer"></g>
            <g id="clocks-layer"></g>
        </svg>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const headerLayer = document.getElementById('header-layer');
        const clocksLayer = document.getElementById('clocks-layer');
        const infoDisplay = document.getElementById('current-info');
        const tooltip = document.getElementById('tooltip');

        const MONTHS_SHORT = ["JAN", "FEV", "MAR", "ABR", "MAI", "JUN", "JUL", "AGO", "SET", "OUT", "NOV", "DEZ"];
        const WEEKDAYS = ["D", "S", "T", "Q", "Q", "S", "S"];

        const totalDays = 365;
        const columns = 21; 
        const cellSize = 38; 
        const clockRadius = 13; 
        
        const now = new Date();
        const year = 2026;
        const startOfYear = new Date(year, 0, 1);
        const startOffset = startOfYear.getDay(); 
        
        const totalRows = Math.ceil((totalDays + startOffset) / columns);
        const startX = 425 - (columns * cellSize) / 2;
        const startY = 60; 

        // Cores harmonizadas: Verde frio (160) -> Vermelho (0)
        function getMonthColor(monthIndex) {
            const progress = monthIndex / 11;
            const h = 160 - (progress * 160); 
            return `hsl(${h}, 65%, 65%)`; 
        }

        function createHeader() {
            const lineTop = document.createElementNS("http://www.w3.org/2000/svg", "line");
            lineTop.setAttribute("x1", startX); lineTop.setAttribute("y1", startY - 35);
            lineTop.setAttribute("x2", startX + columns * cellSize); lineTop.setAttribute("y2", startY - 35);
            lineTop.classList.add("header-line");
            headerLayer.appendChild(lineTop);

            const lineBottom = document.createElementNS("http://www.w3.org/2000/svg", "line");
            lineBottom.setAttribute("x1", startX); lineBottom.setAttribute("y1", startY);
            lineBottom.setAttribute("x2", startX + columns * cellSize); lineBottom.setAttribute("y2", startY);
            lineBottom.classList.add("header-line");
            headerLayer.appendChild(lineBottom);

            for (let i = 0; i <= columns; i++) {
                const x = startX + (i * cellSize);
                const line = document.createElementNS("http://www.w3.org/2000/svg", "line");
                line.setAttribute("x1", x); line.setAttribute("y1", startY - 35);
                line.setAttribute("x2", x); line.setAttribute("y2", startY);
                line.classList.add("header-line");
                headerLayer.appendChild(line);

                if (i < columns) {
                    const text = document.createElementNS("http://www.w3.org/2000/svg", "text");
                    text.setAttribute("x", x + cellSize / 2);
                    text.setAttribute("y", startY - 15);
                    text.classList.add("weekday-header");
                    text.textContent = WEEKDAYS[i % 7];
                    headerLayer.appendChild(text);
                }
            }
        }

        function createTicks(parent) {
            for (let i = 0; i < 60; i++) {
                const angle = (i * 6) * (Math.PI / 180);
                const isHour = i % 5 === 0;
                const length = isHour ? 3 : 1.5;
                const rStart = 17;
                const rEnd = 17 - length;

                const line = document.createElementNS("http://www.w3.org/2000/svg", "line");
                line.setAttribute("x1", rStart * Math.sin(angle));
                line.setAttribute("y1", -rStart * Math.cos(angle));
                line.setAttribute("x2", rEnd * Math.sin(angle));
                line.setAttribute("y2", -rEnd * Math.cos(angle));
                line.classList.add(isHour ? "tick-hour" : "tick-min");
                parent.appendChild(line);
            }
        }

        function createTable() {
            const todayStart = new Date(now.getFullYear(), now.getMonth(), now.getDate());
            const currentDayOfYear = Math.floor((todayStart - startOfYear) / (1000 * 60 * 60 * 24));

            for (let i = 0; i < totalDays; i++) {
                const dayIndex = i + startOffset;
                const row = Math.floor(dayIndex / columns);
                const col = dayIndex % columns;
                const cellX = startX + (col * cellSize);
                const cellY = startY + (row * cellSize);
                const centerX = cellX + cellSize / 2;
                const centerY = cellY + cellSize / 2 + 4;

                const date = new Date(year, 0, i + 1);
                const monthIndex = date.getMonth();
                const isToday = i === currentDayOfYear;

                const g = document.createElementNS("http://www.w3.org/2000/svg", "g");
                g.classList.add("cursor-crosshair");

                const hitArea = document.createElementNS("http://www.w3.org/2000/svg", "rect");
                hitArea.setAttribute("x", cellX); hitArea.setAttribute("y", cellY);
                hitArea.setAttribute("width", cellSize); hitArea.setAttribute("height", cellSize);
                hitArea.setAttribute("fill", "transparent");
                g.appendChild(hitArea);

                if (date.getDate() === 1) {
                    const monthLabel = document.createElementNS("http://www.w3.org/2000/svg", "text");
                    monthLabel.setAttribute("x", cellX + cellSize / 2); 
                    monthLabel.setAttribute("y", cellY + 9);
                    monthLabel.classList.add("month-marker");
                    monthLabel.setAttribute("fill", getMonthColor(monthIndex));
                    monthLabel.textContent = MONTHS_SHORT[monthIndex];
                    g.appendChild(monthLabel);
                }

                const clockG = document.createElementNS("http://www.w3.org/2000/svg", "g");
                clockG.setAttribute("transform", `translate(${centerX}, ${centerY})`);
                
                if (isToday) {
                    const ring = document.createElementNS("http://www.w3.org/2000/svg", "circle");
                    ring.setAttribute("r", clockRadius);
                    ring.classList.add("today-rim-glow");
                    clockG.appendChild(ring);
                } else {
                    const face = document.createElementNS("http://www.w3.org/2000/svg", "circle");
                    face.setAttribute("r", clockRadius);
                    face.classList.add("clock-face-base");
                    clockG.appendChild(face);
                }

                const ticksG = document.createElementNS("http://www.w3.org/2000/svg", "g");
                ticksG.setAttribute("transform", `scale(${clockRadius / 18})`);
                createTicks(ticksG);
                clockG.appendChild(ticksG);

                if (isToday) {
                    const pie = document.createElementNS("http://www.w3.org/2000/svg", "path");
                    pie.setAttribute("id", "today-progress-pie");
                    clockG.appendChild(pie);
                }

                createHand(clockG, "hand-hour", -clockRadius * 0.55, `h-${i}`);
                createHand(clockG, "hand-min", -clockRadius * 0.85, `m-${i}`);
                if (isToday) createHand(clockG, "hand-sec", -clockRadius * 0.95, `s-${i}`);

                g.appendChild(clockG);

                g.addEventListener('mouseenter', () => {
                    tooltip.innerHTML = `
                        <div class="text-xs mb-1 font-bold tracking-wider" style="color:${getMonthColor(monthIndex)}">${date.toLocaleDateString('pt-PT', { weekday: 'long' }).toUpperCase()}</div>
                        <div class="font-bold text-white text-lg">${date.toLocaleDateString('pt-PT', { day: 'numeric', month: 'long' })}</div>
                        ${isToday ? '<div class="text-emerald-400 text-xs mt-1 font-black">★ HOJE</div>' : ''}
                    `;
                    tooltip.style.opacity = 1;
                });
                g.addEventListener('mousemove', (e) => {
                    tooltip.style.left = (e.pageX + 15) + 'px';
                    tooltip.style.top = (e.pageY + 15) + 'px';
                });
                g.addEventListener('mouseleave', () => tooltip.style.opacity = 0);
                clocksLayer.appendChild(g);
            }
        }

        function createHand(parent, className, y2, id) {
            const hand = document.createElementNS("http://www.w3.org/2000/svg", "line");
            hand.setAttribute("x1", 0); hand.setAttribute("y1", 0);
            hand.setAttribute("x2", 0); hand.setAttribute("y2", y2);
            hand.classList.add(className);
            hand.id = id;
            parent.appendChild(hand);
        }

        function describeArc(x, y, radius, startAngle, endAngle) {
            const start = polarToCartesian(x, y, radius, endAngle);
            const end = polarToCartesian(x, y, radius, startAngle);
            const largeArcFlag = endAngle - startAngle <= 180 ? "0" : "1";
            return ["M", x, y, "L", start.x, start.y, "A", radius, radius, 0, largeArcFlag, 0, end.x, end.y, "Z"].join(" ");
        }

        function polarToCartesian(centerX, centerY, radius, angleInDegrees) {
            const angleInRadians = (angleInDegrees - 90) * Math.PI / 180.0;
            return { x: centerX + (radius * Math.cos(angleInRadians)), y: centerY + (radius * Math.sin(angleInRadians)) };
        }

        function updateClocks() {
            const nowUpdate = new Date();
            const s = nowUpdate.getSeconds();
            const m = nowUpdate.getMinutes();
            const h = nowUpdate.getHours();
            const currentMonth = nowUpdate.getMonth();

            const sDeg = s * 6;
            const mDeg = (m * 6) + (s * 0.1);
            const hDeg = (h % 12 * 30) + (m * 0.5);

            for (let i = 0; i < totalDays; i++) {
                const mh = document.getElementById(`m-${i}`);
                const hh = document.getElementById(`h-${i}`);
                if (mh) mh.setAttribute("transform", `rotate(${mDeg})`);
                if (hh) hh.setAttribute("transform", `rotate(${hDeg})`);
                const sh = document.getElementById(`s-${i}`);
                if (sh) sh.setAttribute("transform", `rotate(${sDeg})`);
            }

            const pie = document.getElementById('today-progress-pie');
            if (pie) {
                const totalSecondsPassed = (h * 3600) + (m * 60) + s;
                const endAngle = (totalSecondsPassed / 86400) * 359.99;
                pie.setAttribute("d", describeArc(0, 0, clockRadius, 0, endAngle));
            }

            const timeStr = nowUpdate.toLocaleTimeString('pt-PT', { hour: '2-digit', minute: '2-digit', second: '2-digit' });
            const dateStr = nowUpdate.toLocaleDateString('pt-PT', { day: '2-digit', month: 'long', year: 'numeric' }).toUpperCase();
            
            const themeColor = getMonthColor(currentMonth);
            infoDisplay.style.color = themeColor;
            infoDisplay.style.borderColor = themeColor.replace('65%', '30%');
            infoDisplay.innerHTML = `<span class="opacity-60 text-sm sm:text-lg">${dateStr}</span> <span class="mx-3 opacity-20">|</span> <span class="font-black">${timeStr}</span>`;
        }

        createHeader();
        createTable();
        updateClocks();
        setInterval(updateClocks, 1000);
    </script>
</body>
</html>